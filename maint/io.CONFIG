#!/bin/bash

declare -A locations
declare -A RAMDisks

ERRLOG="$HOME/.io/logs/Prepdot.md"

# Add some Color to those messages!!
source $HOME/.io/.blanks/color
source $HOME/.io/config/.Locations
source $HOME/.io/config/.RAMDisks

if [ ! -f $ERRLOG ]
then
    mkdir ~/.io/logs
    echo generate > $ERRLOG
fi

printf "  \n # Begin $HOSTNAME :: $(date) \n\`\`\`" >> $ERRLOG

#echo "${locations[@]}" | tee $ERRLOG -a
#for t in ${!locations[@]}
#do
#  echo ${locations[$t]}| tee $ERRLOG -a
#done

for l in ${!locations[@]}
do
	printf  "${locations[$l]} SAVED STATE >> ~/.defaults.tbz2\n" | tee $ERRLOG -a
	sudo tar -cjvf - ${locations[$l]} >> ~/.defaults.tbz2 --remove-files -P
	printf "$l to ${locations[$l]}\n"|tee $ERRLOG -a

  if [ $l = '.bashrc' ]
  then
#      printf '\n```  \n' >> $ERRLOG
      cp -vrT $HOME/.io/config/$l ${locations[$l]} >> $ERRLOG 2>&1
#      printf '\n```  \n' >> $ERRLOG
  else
#      printf '\n```  \n' >> $ERRLOG
      sudo cp -v $HOME/.io/config/$l ${locations[$l]} >> $ERRLOG 2>&1
#      printf '\n```  \n' >> $ERRLOG
  fi
done

#for r in ${!RAMDisks[@]}
#do
#  ~/.io/blanks/set.RAMDISK ""
#done
$HOME/.io/set.BLANKS
$HOME/.io/set.RUBY
$HOME/.io/set.FONTS
$HOME/.io/set.NANO

# Install nano links in place of vi/vim
ln -s /usr/bin/nano /usr/bin/vi

printf "\`\`\`  \n # End $HOSTNAME :: $(date) \n" >> $ERRLOG

printf "Turn on WiFi?\n"
read WiON

if [ $WiON ]
then
    case $WiON in
    y)
      $HOME/.io/wifi.ON
    ;;
    yes)
      $HOME/.io/wifi.ON
    ;;
    n)
      printf "NOT turning on WiFi\n"
    ;;
    no)
      printf "NOT turning on WiFi\n"
    ;;
    *)
      printf "Not sure what that means... gonna not WiFi\n"
    ;;
    esac
fi

printf "Turn on GUI?\n"
read guiON

if [ $guiON ]
then
    case $guiON in
    y)
      startxfce4
    ;;
    yes)
      startxfce4
    ;;
    n)
      printf "NOT turning on GUI\n"
    ;;
    no)
      printf "NOT turning on GUI\n"
    ;;
    *)
      printf "Not sure what that means... no GUI for you.\n"
    ;;
    esac
fi

# sudo apt install -y autojump
unset ERRLOG WiON guiON

#####
#   Next generation will have a separate keyfile { rcfile='path', etc. }
# thusly it will batch install rcfiles for expandability
